# Новинки и планы издательств, авторов

API в точности повторяет раздел https://fantlab.ru/pubnews

Веб-версия строится ровно по тем же данным, что и выводятся в АПИ.

В разделе АПИ три подраздела:
```
/pubnews.json   - Новинки издательств
/pubplans.json  - Планы издательств
/autplans.json  - Планы авторов
```

Первые два - списки изданий. Третьей - список произведений.

В урле запроса допустимы параметры: lang, sort, page, pub_id.

lang - язык.
```
lang=0  - русскоязычное
lang=1  - зарубежное
lang=2  - и то, и другое
```

sort - сортировка. В каждом из трёх подразделов свой набор доступных сортировок:
```
/pubnews.json
  date - по дате (выхода)
  type - по типу (издания)
  pub - по издательству и серии
  author - по автору
  title - по наименованию
/pubplans.json  - Планы издательств
  corect - по изменению (дате последней правки издания)   - единственное отличие от набора сортировок /pubnews.json
  date - по дате (выхода)
  type - по типу (издания)
  pub - по издательству и серии
  author - по автору
  title - по наименованию
/autplans.json  - Планы авторов
  corect - по изменению (дате добавления произведения)
  author - по автору
  title - по наименованию
```

pub_id - выбор конкретного издательства по его ID.
Доступно только в разделах pubnews и pubplans.

page - страница.


# выдача

all_pages_access_to_user_class  - номер класса посетителя, начиная с которого (включительно) можно открывать ему page=all.
Это небольшая защита от излишней нагрузки на сервер, а также от пауков-парсеров, которым удобнее одну страницу парсить.

has_news_plans - хэш из шести значений. Каждое или null или 1. Единица означает, что в этом разделе есть новые объекты (ворки или эдишны), которых юзер ещё не видел. Цифра в названии - это lang.
Например, pubplans1_new=1 означает, что в Планах издательств (зарубежных) есть что-то новое.

image_url - префикс урла всех картинок (ворки и эдишны)

interval_days - за сколько дней показываются новинки и планы (это можно где-то снизу под звёздочкой указать, как на сайте)

lang - выбранный язык (0 - русский, 1 - зарубежный, 2 - оба)

last_read_date - дата, когда юзер последний раз заходил в этот подраздел (один из трёх) и с учётом выбранного языка. См выше - хеш has_news_plans. Он как раз выдаётся по этой дате (которых также физически шесть в базе).

mode - это своего рода урл после fantlab.ru, но без параметров. Значения: pubnews, pubplans, autplans.

objects - собственно массив-список объектов (изданий или произведений).
  В нём:
  - correct_date - дата последней правки издания/ворка
  - date - дата или выхода или плана выхода издания. На сайте справа от издания выводится именно она
  - first_edition - является ли первым изданием
  - ozon_available - доступность на озоне (0,1)
  - ozon_cost - цена на озоне 
  - ozon_id - id на озоне
  - аналогично с лабиринтом
  - plan_description - описание/примечание к плану издания книги
  - preread - есть ли кусок pdf-а для ознакомления (0, 1)
  - release_date - Фактическое начало продаж
  - sort_string - по этому полю идёт сортировка при sort in (author, title). С этого поля можно откусывать первый символ, чтобы рисовать подзаголовки: "авторы на букву А, затем Б...". Как на сайте.
  - subscribed - подписан ли юзер на выход этого издания (для подраздела планов изданий)
  - the_only_work - вложенный хэш, которые заполняется данными о произведении, если оно в этом издании одно
  - остальное должно быть понятно и так
  
 objects_in_page - сколько объектов на странице показывается
 
 pub_id и pub_name - издательство, выбранное из ниспадающего списка (для разделов новинок и планов издательств)
 
 publisher_list - список всех издательств, чьи издания встречены в этом разделе. Для выбора из ниспадающего списка.
 
 pubnews_communities - доп.информация об рубриках в блогах, де публикуются новинки. Там же показано на какие из них подписан юзер. В принципе, можно и через приложуху сделать подписку.
